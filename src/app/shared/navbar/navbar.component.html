<nav class="navbar">
    <div class="navbar-left">
        <button class="menu-btn" (click)="toggleSidebar()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        </button>
        <div class="brand-icon">
            <!-- Robot Arm Icon Mockup -->
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M19 4h-2V2h-2v2H9V2H7v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V6h14v14z"
                    fill="#D97706" />
                <path d="M7 10h2v2H7zm0 4h2v2H7zm4-4h2v2h-2zm0 4h2v2h-2zm4-4h2v2h-2zm0 4h2v2h-2z" fill="#D97706"
                    opacity="0.6" />
            </svg>
        </div>
        <div class="brand-text">
            <h1>Maintenance Command</h1>
            <span class="version">SYSTEM V2.4</span>
        </div>
    </div>

    <div class="navbar-center">
        <ul class="nav-links">
            <li class="nav-item" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
                <a routerLink="/home">Overview</a>
            </li>
            <li class="nav-item" routerLinkActive="active">
                <a routerLink="/equipment-list">Equipment</a>
            </li>
            <li class="nav-item" routerLinkActive="active">
                <a routerLink="/maintenance-calendar">Schedule</a>
            </li>
            <li class="nav-item" routerLinkActive="active">
                <a routerLink="/insights-dashboard">Reports</a>
            </li>
        </ul>
    </div>

    <div class="navbar-right">
        <!-- Search Wrapper -->
        <div class="search-container" [class.expanded]="isSearchOpen">
            <button class="icon-btn search-btn" (click)="toggleSearch()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" class="icon-svg" *ngIf="!isSearchOpen">
                    <path
                        d="M21 21L15 15M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <span class="material-icons" *ngIf="isSearchOpen">close</span>
            </button>

            <input type="text" id="global-search-input" class="search-input"
                [placeholder]="isSearchOpen ? 'Search pages...' : ''" (input)="onSearch($event)" [value]="searchQuery">

            <!-- Search Results Dropdown -->
            <div class="search-results" *ngIf="isSearchOpen && searchResults.length > 0">
                <div class="result-item" *ngFor="let result of searchResults" (click)="navigateTo(result.route)">
                    <span class="material-icons item-icon">description</span>
                    {{ result.name }}
                </div>
            </div>
        </div>

        <app-notification-bell></app-notification-bell>

        <div class="profile-section">
            <div class="profile-info" (click)="authService.openProfile()">
                <span class="name">{{ authService.currentUser()?.name }}</span>
                <span class="role">{{ authService.currentUser()?.role }}</span>
            </div>
            <div class="profile-avatar" (click)="authService.openProfile()">
                <div class="avatar-initial">{{ authService.currentUser()?.name?.charAt(0) }}</div>
                <div class="status-indicator"></div>
            </div>
            <button class="dropdown-trigger" (click)="toggleDropdown()">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M6 9l6 6 6-6" />
                </svg>
            </button>

            @if (isDropdownOpen) {
            <div class="dropdown-menu">
                <button class="dropdown-item" (click)="authService.openProfile()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round" class="mr-2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    Profile
                </button>
                <button class="dropdown-item logout-btn" (click)="logout()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round" class="mr-2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                    Logout
                </button>
            </div>
            }
        </div>
    </div>
</nav>